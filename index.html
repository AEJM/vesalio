<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Reproductor multilingüe vertical</title>
<style>
  :root {
    --beige:#f6f0e8;
    --white:#ffffff;
    --black:#000000;
    --accent:#2b6cb0;
    --active:#1d4ed8;
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--beige);
    font-family:Inter, system-ui, sans-serif;
    display:flex; align-items:center; justify-content:center;
    min-height:100dvh; padding:20px;
  }

  .container{
    width:min(520px,95vw);
    background:var(--white);
    border-radius:var(--radius);
    box-shadow:0 4px 20px rgba(0,0,0,.1);
    /* Importante: permitir sticky */
    overflow:visible;
    display:flex; flex-direction:column;
  }

  /* Selector de idioma SIEMPRE visible */
  .lang-bar{
    display:flex; justify-content:space-between; align-items:center;
    background:#fafafa; border-bottom:1px solid #ddd;
    padding:10px; gap:8px; flex-wrap:wrap;
    position:sticky; top:0; z-index:1000; /* se mantiene visible al hacer scroll */
  }
  .lang-group{display:flex; gap:8px; flex-wrap:wrap}
  .lang-btn{
    display:flex; align-items:center; gap:6px;
    padding:6px 12px; border:1px solid #ccc; border-radius:8px;
    background:#fff; font-weight:600; color:#333; cursor:pointer;
    transition:.2s; white-space:nowrap;
  }
  .lang-btn img{width:20px; height:14px; object-fit:cover}
  .lang-btn:hover{background:#f0f0f0}
  .lang-btn.active{border-color:var(--active); background:#eaf1ff; color:var(--active)}
  .brand{font-weight:700; color:#444}

  /* Reproductor vertical 9:16 */
  .video-panel{
    position:relative; aspect-ratio:9/16; background:var(--black);
  }
  .video-panel iframe{
    position:absolute; inset:0; width:100%; height:100%; border:0;
  }
  .version-label{
    position:absolute; top:8px; left:8px;
    background:rgba(255,255,255,0.9);
    color:#000; font-size:13px; padding:4px 8px;
    border-radius:6px; font-weight:600;
  }

  /* Responsivo: sin espacios laterales en móvil */
  @media (max-width:640px){
    body{padding:0;}
    .container{
      width:100vw; border-radius:0; box-shadow:none;
    }
    .lang-group{overflow-x:auto}
    .video-panel{width:100vw;}
  }
</style>
</head>
<body>
  <div class="container">
    <!-- Barra de selección de idioma (siempre visible) -->
    <div class="lang-bar" id="langBar" role="tablist" aria-label="Selector de idioma">
      <div class="brand">Idioma</div>
      <div class="lang-group">
        <button class="lang-btn active" data-lang="es" role="tab" aria-selected="true">
          <img src="https://flagcdn.com/w20/es.png" alt="ES"> Español
        </button>
        <button class="lang-btn" data-lang="en" role="tab" aria-selected="false">
          <img src="https://flagcdn.com/w20/gb.png" alt="EN"> English
        </button>
        <button class="lang-btn" data-lang="fr" role="tab" aria-selected="false">
          <img src="https://flagcdn.com/w20/fr.png" alt="FR"> Français
        </button>
        <button class="lang-btn" data-lang="de" role="tab" aria-selected="false">
          <img src="https://flagcdn.com/w20/de.png" alt="DE"> Deutsch
        </button>
      </div>
    </div>

    <!-- Panel del video -->
    <div class="video-panel" id="stage">
      <span class="version-label" id="langLabel">Versión: Español</span>
      <iframe id="videoFrame" allow="autoplay; fullscreen; picture-in-picture; encrypted-media"></iframe>
    </div>
  </div>

<script>
  /* Función base: compartir → /preview (sin cambios) */
  function driveShareToPreview(url){
    try{
      const m = url.match(/\/d\/([a-zA-Z0-9_-]{10,})\//);
      if(m && m[1]) return `https://drive.google.com/file/d/${m[1]}/preview`;
      const u = new URL(url);
      const id = u.searchParams.get('id');
      if(id) return `https://drive.google.com/file/d/${id}/preview`;
    }catch(e){}
    return null;
  }

  /* URLs por idioma (sin cambios) */
  const LANG_URLS = {
    es: "https://drive.google.com/file/d/1d-KY6xlh7hy9cVniYmfDk2rWVrclNMz3/view?usp=drive_link",
    en: "https://drive.google.com/file/d/1d-KY6xlh7hy9cVniYmfDk2rWVrclNMz3/view?usp=drive_link",
    fr: "https://drive.google.com/file/d/1d-KY6xlh7hy9cVniYmfDk2rWVrclNMz3/view?usp=drive_link", // opcional: agrega link en francés
    de: "https://drive.google.com/file/d/1d-KY6xlh7hy9cVniYmfDk2rWVrclNMz3/view?usp=drive_link"  // opcional: agrega link en alemán
  };

  const frame = document.getElementById("videoFrame");
  const langLabel = document.getElementById("langLabel");
  const langButtons = document.querySelectorAll(".lang-btn");

  function loadFromDriveLink(url){
    const preview = driveShareToPreview(url);
    if(!preview){ alert("Enlace de Drive inválido o vacío"); return; }
    frame.src = preview;
  }

  /* Cambio de idioma (sin cambios) */
  langButtons.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      langButtons.forEach(b=>{
        b.classList.remove("active");
        b.setAttribute("aria-selected","false");
      });
      btn.classList.add("active");
      btn.setAttribute("aria-selected","true");
      const code = btn.dataset.lang;
      const labelMap = {es:"Español", en:"English", fr:"Français", de:"Deutsch"};
      langLabel.textContent = "Versión: " + (labelMap[code] || "Español");

      const url = LANG_URLS[code] || "";
      if(!url){
        alert("No se ha configurado el enlace para: " + (labelMap[code] || code.toUpperCase()));
        return;
      }
      loadFromDriveLink(url);
    });
  });

  /* Carga inicial: Español */
  loadFromDriveLink(LANG_URLS.es);
</script>
</body>
</html>
